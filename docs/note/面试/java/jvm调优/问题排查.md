Java进程CPU飙升到900%，怎么处理？
CPU飙升问题定位的一般步骤是：

1.首先通过top指令查看当前占用CPU较高的进程PID；

```bash
top
```

> (shift+p)按照cpu排序  (shift+m) 按照内存排序

2. 查看当前进程消耗资源的线程PID：

```bash
top -Hp pid
```

3. 通过print命令将线程PID转为16进制，根据该16进制值去打印堆栈日志内查询，查看该线程所驻留的方法位置。

```
printf “%x\n” 命令（tid指线程的id号）
```

4. 通过jstack命令，查看栈信息，定位到线程对应的具体代码。

```
jstack -l PID ./abc.txt
grep -A nid(线程ID) ./abc.txt
 
合并处理
jstack <pid> |grep -A 200 <nid>
```

5. 分析代码解决问题。

1. **jps**：Java Virtual Machine Process Status Tool，用于列出当前系统中所有的Java进程，显示进程ID和对应的主类。

2. **jstat**：Java Virtual Machine Statistics Monitoring Tool，用于监视JVM内存、类装载、垃圾回收等情况。

3. **jstack**：Java Stack Trace，用于生成Java进程的线程快照，显示各个线程的调用栈信息，帮助定位死锁或性能问题。

4. **jmap**：Java Memory Map，用于生成Java进程的内存映射信息，包括堆内存使用情况、对象实例分布等。

jvm常用设置参数

1. **堆内存设置**：
   - -Xms<size> ：设置初始堆内存大小。
   - -Xmx<size> ：设置最大堆内存大小。

2. **垃圾回收设置**：
   - -XX:+UseSerialGC ：使用串行垃圾回收器。
   - -XX:+UseParallelGC ：使用并行垃圾回收器。
   - -XX:+UseConcMarkSweepGC ：使用CMS垃圾回收器。
   - -XX:+UseG1GC ：使用G1垃圾回收器。

3. **堆内存分代设置**：
   - -XX:NewSize=<size> ：设置新生代初始大小。
   - -XX:MaxNewSize=<size> ：设置新生代最大大小。
   - -XX:NewRatio=<ratio> ：设置新生代和老年代的比例。

4. **元空间（Metaspace）设置**：
   - -XX:MaxMetaspaceSize=<size> ：设置元空间最大大小。

5. **栈内存设置**：
   - -Xss<size> ：设置线程栈大小。

6. **性能调优**：
   - -XX:+AggressiveOpts ：启用更激进的优化。
   - -XX:+UseLargePages ：使用大页面内存。

7. **调试设置**：
   - -Xdebug ：启用调试模式。
   - -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=<port> ：启用远程调试。

8. **GC日志**：
   - -Xloggc:<file> ：将GC日志输出到指定文件。
   - -XX:+PrintGCDetails ：打印GC详细信息。
